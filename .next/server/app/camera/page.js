(()=>{var e={};e.id=36,e.ids=[36],e.modules={753:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>j});var t=r(687),a=r(3210),i=r(6189),l=r(1126);let n={width:1280,height:720,facingMode:"environment",audio:!1},c=(e={})=>{let[s,r]=(0,a.useState)({isActive:!1,isCapturing:!1,hasPermission:!1,error:null,stream:null}),t=(0,a.useRef)(null),i=(0,a.useRef)(null),c={...n,...e},d=(0,a.useCallback)(async()=>{try{r(e=>({...e,error:null}));let e={video:{width:{ideal:c.width},height:{ideal:c.height},facingMode:c.facingMode},audio:c.audio},s=await navigator.mediaDevices.getUserMedia(e);return i.current=s,r(e=>({...e,hasPermission:!0,stream:s,error:null})),{success:!0}}catch(s){let e=s instanceof Error?s.message:"Camera access denied";return r(s=>({...s,hasPermission:!1,error:e})),{success:!1,error:e}}},[c]),o=(0,a.useCallback)(async()=>{if(!s.hasPermission){let e=await d();if(!e.success)return e}try{if(t.current&&i.current)return t.current.srcObject=i.current,await t.current.play(),r(e=>({...e,isActive:!0,error:null})),{success:!0};return{success:!1,error:"Video element not available"}}catch(s){let e=s instanceof Error?s.message:"Failed to start camera";return r(s=>({...s,error:e})),{success:!1,error:e}}},[s.hasPermission,d]),u=(0,a.useCallback)(()=>{i.current&&(i.current.getTracks().forEach(e=>e.stop()),i.current=null),t.current&&(t.current.srcObject=null),r(e=>({...e,isActive:!1,stream:null}))},[]),x=(0,a.useCallback)(()=>{if(!t.current||!s.isActive)return null;try{r(e=>({...e,isCapturing:!0}));let e=l.C.captureFromVideo(t.current,c.width,c.height);return r(e=>({...e,isCapturing:!1})),e}catch(e){return r(s=>({...s,isCapturing:!1,error:e instanceof Error?e.message:"Failed to capture image"})),null}},[s.isActive,c.width,c.height]),m=(0,a.useCallback)(async()=>{let e="user"===c.facingMode?"environment":"user";u();let s={...c,facingMode:e};try{let e={video:{width:{ideal:s.width},height:{ideal:s.height},facingMode:s.facingMode},audio:s.audio},a=await navigator.mediaDevices.getUserMedia(e);return i.current=a,t.current&&(t.current.srcObject=a,await t.current.play()),r(e=>({...e,isActive:!0,stream:a,error:null})),{success:!0}}catch(s){let e=s instanceof Error?s.message:"Failed to switch camera";return r(s=>({...s,error:e})),{success:!1,error:e}}},[c,u]),h=(0,a.useCallback)(async()=>(u(),r(e=>({...e,error:null,hasPermission:!1})),await o()),[u,o]);(0,a.useEffect)(()=>()=>{u()},[u]);let p=(0,a.useCallback)(()=>!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia),[]);return{...s,videoRef:t,requestPermission:d,startCamera:o,stopCamera:u,captureImage:x,switchCamera:m,retryCamera:h,isCameraSupported:p,config:c}};var d=r(1240),o=r(9422),u=r(9523),x=r(4493),m=r(1821),h=r(6834),p=r(5814),g=r.n(p);function j(){let e=(0,i.useRouter)(),{isAuthenticated:s}=(0,o.A)(),{videoRef:r,isActive:l,isCapturing:n,hasPermission:p,error:j,startCamera:v,stopCamera:f,captureImage:b,switchCamera:y,retryCamera:N,isCameraSupported:w}=c(),{isLoaded:C,isLoading:k,isAnalyzing:A,analyzeImageFromCamera:P,error:R}=(0,d.i)(),[E,_]=(0,a.useState)(null),[q,z]=(0,a.useState)(!1),[M,D]=(0,a.useState)(null),F=async()=>{let e=await v();e.success||console.error("Failed to start camera:",e.error)},$=async()=>{try{let e=b();if(!e)return void alert("Failed to capture image. Please try again.");D(e.dataUrl),z(!0);let s=await P(e);s?_(s):alert("Analysis failed. Please try again.")}catch(e){console.error("Error during capture and analysis:",e),alert("An error occurred. Please try again.")}};return w()?(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(g(),{href:"/",children:(0,t.jsx)(u.$,{variant:"ghost",size:"sm",children:"← Back"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"Live Camera Detection"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Real-time plant disease analysis"})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[C&&(0,t.jsx)(h.E,{variant:"default",className:"bg-green-100 text-green-800",children:"AI Model Ready"}),k&&(0,t.jsx)(h.E,{variant:"secondary",children:"Loading AI Model..."})]})]})})}),(0,t.jsx)("main",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:q?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Analysis Results"}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)(u.$,{onClick:()=>{z(!1),_(null),D(null)},variant:"outline",children:"Take Another Photo"}),s&&E&&(0,t.jsx)(u.$,{onClick:()=>{E&&e.push("/results")},className:"bg-green-600 hover:bg-green-700",children:"View All Results"})]})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,t.jsxs)(x.Zp,{children:[(0,t.jsx)(x.aR,{children:(0,t.jsx)(x.ZB,{children:"Captured Image"})}),(0,t.jsx)(x.Wu,{children:M&&(0,t.jsx)("img",{src:M,alt:"Captured plant",className:"w-full h-64 object-cover rounded-lg"})})]}),(0,t.jsxs)(x.Zp,{children:[(0,t.jsxs)(x.aR,{children:[(0,t.jsx)(x.ZB,{children:"Detection Results"}),(0,t.jsx)(x.BT,{children:E?`Analysis completed with ${E.confidence.toFixed(1)}% confidence`:"Analyzing image..."})]}),(0,t.jsx)(x.Wu,{children:A?(0,t.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Analyzing plant health..."})]})}):E?(0,t.jsx)("div",{className:"space-y-4",children:E.isHealthy?(0,t.jsxs)("div",{className:"text-center py-4",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)("div",{className:"w-8 h-8 bg-green-600 rounded-full"})}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-green-600 mb-2",children:"Healthy Plant Detected!"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Your plant appears to be healthy with no signs of disease."})]}):(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"font-semibold text-red-600 mb-3",children:"Disease Detected"}),E.detectedDiseases.map((e,s)=>(0,t.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900",children:e.name}),(0,t.jsxs)(h.E,{variant:"destructive",children:[e.confidence?.toFixed(1),"%"]})]}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:e.description}),e.treatments.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h5",{className:"font-medium text-sm mb-2",children:"Recommended Treatment:"}),(0,t.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg",children:[(0,t.jsx)("p",{className:"font-medium text-sm text-blue-900",children:e.treatments[0].name}),(0,t.jsx)("p",{className:"text-xs text-blue-700 mt-1",children:e.treatments[0].description}),(0,t.jsxs)("div",{className:"mt-2 text-xs text-blue-600",children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Application:"})," ",e.treatments[0].applicationMethod]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Dosage:"})," ",e.treatments[0].dosage]})]})]})]})]},e.id))]})}):(0,t.jsx)("div",{className:"text-center py-8 text-gray-500",children:"Analysis failed. Please try again."})})]})]}),E&&!E.isHealthy&&(0,t.jsxs)(x.Zp,{children:[(0,t.jsx)(x.aR,{children:(0,t.jsx)(x.ZB,{children:"Next Steps"})}),(0,t.jsx)(x.Wu,{children:(0,t.jsxs)("div",{className:"grid sm:grid-cols-2 gap-4",children:[(0,t.jsx)(g(),{href:"/results",children:(0,t.jsx)(u.$,{variant:"outline",className:"w-full",children:"View Treatment Details"})}),(0,t.jsx)(u.$,{variant:"outline",className:"w-full",children:"Export Report"})]})})]})]}):(0,t.jsxs)("div",{className:"space-y-6",children:[(j||R)&&(0,t.jsx)(m.Fc,{variant:"destructive",children:(0,t.jsxs)(m.TN,{children:[j||R,j&&(0,t.jsx)(u.$,{variant:"outline",size:"sm",className:"ml-2",onClick:N,children:"Retry"})]})}),!C&&!k&&(0,t.jsx)(m.Fc,{children:(0,t.jsx)(m.TN,{children:"AI model is loading. Please wait for better detection accuracy."})}),(0,t.jsx)(x.Zp,{className:"overflow-hidden",children:(0,t.jsx)(x.Wu,{className:"p-0",children:(0,t.jsxs)("div",{className:"relative bg-black aspect-video",children:[l?(0,t.jsx)("video",{ref:r,className:"w-full h-full object-cover",autoPlay:!0,playsInline:!0,muted:!0}):(0,t.jsx)("div",{className:"flex items-center justify-center h-full text-white",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-gray-600 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)("div",{className:"w-8 h-8 bg-gray-400 rounded-full"})}),(0,t.jsx)("p",{className:"text-lg mb-2",children:"Camera Not Active"}),(0,t.jsx)("p",{className:"text-sm text-gray-300",children:'Click "Start Camera" to begin detection'})]})}),l&&(0,t.jsxs)("div",{className:"absolute inset-0 pointer-events-none",children:[(0,t.jsx)("div",{className:"absolute inset-4 border-2 border-white border-dashed rounded-lg opacity-50"}),(0,t.jsx)("div",{className:"absolute top-4 left-4 right-4",children:(0,t.jsxs)("div",{className:"bg-black bg-opacity-50 text-white p-3 rounded-lg text-sm",children:[(0,t.jsx)("p",{className:"font-medium mb-1",children:"Detection Tips:"}),(0,t.jsxs)("ul",{className:"text-xs space-y-1",children:[(0,t.jsx)("li",{children:"• Hold camera steady and focus on leaves"}),(0,t.jsx)("li",{children:"• Ensure good lighting conditions"}),(0,t.jsx)("li",{children:"• Keep plant within the frame"})]})]})}),(0,t.jsx)("div",{className:"absolute bottom-4 left-4 right-4 flex justify-between items-center",children:(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)(h.E,{variant:C?"default":"secondary",children:C?"AI Ready":"AI Loading"}),(0,t.jsx)(h.E,{variant:"outline",className:"bg-black bg-opacity-50 text-white border-white",children:"Live"})]})})]})]})})}),(0,t.jsx)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:l?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.$,{onClick:$,size:"lg",className:"bg-blue-600 hover:bg-blue-700",disabled:n||A||!C,children:n||A?(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),(0,t.jsx)("span",{children:n?"Capturing...":"Analyzing..."})]}):"Capture & Analyze"}),(0,t.jsx)(u.$,{onClick:y,variant:"outline",size:"lg",children:"Switch Camera"}),(0,t.jsx)(u.$,{onClick:f,variant:"outline",size:"lg",children:"Stop Camera"})]}):(0,t.jsx)(u.$,{onClick:F,size:"lg",className:"bg-green-600 hover:bg-green-700",disabled:!p&&null!==j,children:"Start Camera"})}),(0,t.jsxs)(x.Zp,{children:[(0,t.jsx)(x.aR,{children:(0,t.jsx)(x.ZB,{className:"text-lg",children:"How to Use"})}),(0,t.jsx)(x.Wu,{children:(0,t.jsxs)("ol",{className:"list-decimal list-inside space-y-2 text-sm text-gray-600",children:[(0,t.jsx)("li",{children:'Click "Start Camera" to activate your device camera'}),(0,t.jsx)("li",{children:"Point the camera at plant leaves you want to analyze"}),(0,t.jsx)("li",{children:"Ensure good lighting and focus on the plant"}),(0,t.jsx)("li",{children:'Click "Capture & Analyze" to take a photo and detect diseases'}),(0,t.jsx)("li",{children:"Review the results and treatment recommendations"})]})})]})]})})]}):(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:(0,t.jsxs)(x.Zp,{className:"w-full max-w-md",children:[(0,t.jsxs)(x.aR,{children:[(0,t.jsx)(x.ZB,{className:"text-red-600",children:"Camera Not Supported"}),(0,t.jsx)(x.BT,{children:"Your device or browser doesn't support camera access"})]}),(0,t.jsxs)(x.Wu,{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Please try using a modern browser or upload images from your gallery instead."}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(g(),{href:"/gallery",children:(0,t.jsx)(u.$,{className:"w-full",children:"Upload from Gallery"})}),(0,t.jsx)(g(),{href:"/",children:(0,t.jsx)(u.$,{variant:"outline",className:"w-full",children:"Back to Home"})})]})]})]})})}},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1204:e=>{"use strict";e.exports=require("string_decoder")},1522:(e,s,r)=>{Promise.resolve().then(r.bind(r,753))},1630:e=>{"use strict";e.exports=require("http")},1770:(e,s,r)=>{Promise.resolve().then(r.bind(r,3020))},1821:(e,s,r)=>{"use strict";r.d(s,{Fc:()=>n,TN:()=>c});var t=r(687);r(3210);var a=r(4224),i=r(4780);let l=(0,a.F)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function n({className:e,variant:s,...r}){return(0,t.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,i.cn)(l({variant:s}),e),...r})}function c({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"alert-description",className:(0,i.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",e),...s})}},1997:e=>{"use strict";e.exports=require("punycode")},3020:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>t});let t=(0,r(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/project/sandbox/user-workspace/src/app/camera/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/project/sandbox/user-workspace/src/app/camera/page.tsx","default")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},4075:e=>{"use strict";e.exports=require("zlib")},5511:e=>{"use strict";e.exports=require("crypto")},5591:e=>{"use strict";e.exports=require("https")},6189:(e,s,r)=>{"use strict";var t=r(5773);r.o(t,"useRouter")&&r.d(s,{useRouter:function(){return t.useRouter}})},7910:e=>{"use strict";e.exports=require("stream")},8354:e=>{"use strict";e.exports=require("util")},9021:e=>{"use strict";e.exports=require("fs")},9087:(e,s,r)=>{"use strict";r.r(s),r.d(s,{GlobalError:()=>l.a,__next_app__:()=>u,pages:()=>o,routeModule:()=>x,tree:()=>d});var t=r(5239),a=r(8088),i=r(8170),l=r.n(i),n=r(893),c={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);r.d(s,c);let d={children:["",{children:["camera",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,3020)),"/project/sandbox/user-workspace/src/app/camera/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,4431)),"/project/sandbox/user-workspace/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,7398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,5284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,o=["/project/sandbox/user-workspace/src/app/camera/page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},x=new t.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/camera/page",pathname:"/camera",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9551:e=>{"use strict";e.exports=require("url")}};var s=require("../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),t=s.X(0,[435,750,24,326],()=>r(9087));module.exports=t})();