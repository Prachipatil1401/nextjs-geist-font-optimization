(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[178],{4530:()=>{},8108:()=>{},18590:()=>{},26126:(e,t,i)=>{"use strict";i.d(t,{E:()=>l});var a=i(95155);i(12115);var r=i(54624),s=i(74466),o=i(59434);let n=(0,s.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:i,asChild:s=!1,...l}=e,d=s?r.DX:"span";return(0,a.jsx)(d,{"data-slot":"badge",className:(0,o.cn)(n({variant:i}),t),...l})}},30285:(e,t,i)=>{"use strict";i.d(t,{$:()=>l});var a=i(95155);i(12115);var r=i(54624),s=i(74466),o=i(59434);let n=(0,s.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function l(e){let{className:t,variant:i,size:s,asChild:l=!1,...d}=e,c=l?r.DX:"button";return(0,a.jsx)(c,{"data-slot":"button",className:(0,o.cn)(n({variant:i,size:s,className:t})),...d})}},39471:(e,t,i)=>{"use strict";i.d(t,{A:()=>l});var a=i(12115);let r="agrodrone_auth",s="agrodrone_users";class o{static getInstance(){return o.instance||(o.instance=new o),o.instance}loadAuthState(){try{let e=localStorage.getItem(r);if(e){let t=JSON.parse(e);this.authState={user:t.user,isAuthenticated:!0,isLoading:!1}}}catch(e){console.error("Error loading auth state:",e)}}saveAuthState(){try{localStorage.setItem(r,JSON.stringify({user:this.authState.user,timestamp:new Date().toISOString()}))}catch(e){console.error("Error saving auth state:",e)}}getUsers(){try{let e=localStorage.getItem(s);return e?JSON.parse(e):[]}catch(e){return console.error("Error loading users:",e),[]}}saveUsers(e){try{localStorage.setItem(s,JSON.stringify(e))}catch(e){console.error("Error saving users:",e)}}async register(e){try{this.authState.isLoading=!0;let t=this.getUsers();if(t.find(t=>t.email===e.email))return this.authState.isLoading=!1,{success:!1,message:"User with this email already exists"};let i={id:Date.now().toString(),username:e.username,email:e.email,mobileNo:e.mobileNo,createdAt:new Date},a={...i,password:e.password};return t.push(a),this.saveUsers(t),this.authState={user:i,isAuthenticated:!0,isLoading:!1},this.saveAuthState(),{success:!0,message:"Registration successful",user:i}}catch(e){return this.authState.isLoading=!1,{success:!1,message:"Registration failed. Please try again."}}}async login(e){try{this.authState.isLoading=!0;let t=this.getUsers().find(t=>t.email===e.email&&t.password===e.password);if(!t)return this.authState.isLoading=!1,{success:!1,message:"Invalid email or password"};let{password:i,...a}=t;return this.authState={user:a,isAuthenticated:!0,isLoading:!1},this.saveAuthState(),{success:!0,message:"Login successful",user:a}}catch(e){return this.authState.isLoading=!1,{success:!1,message:"Login failed. Please try again."}}}logout(){this.authState={user:null,isAuthenticated:!1,isLoading:!1},localStorage.removeItem(r)}getAuthState(){return{...this.authState}}getCurrentUser(){return this.authState.user}isAuthenticated(){return this.authState.isAuthenticated}constructor(){this.authState={user:null,isAuthenticated:!1,isLoading:!1},this.loadAuthState()}}let n=o.getInstance(),l=()=>{let[e,t]=(0,a.useState)({user:null,isAuthenticated:!1,isLoading:!0});(0,a.useEffect)(()=>{t(n.getAuthState())},[]);let i=async e=>{t(e=>({...e,isLoading:!0}));try{let i=await n.login(e);return i.success&&i.user?t({user:i.user,isAuthenticated:!0,isLoading:!1}):t(e=>({...e,isLoading:!1})),i}catch(e){return t(e=>({...e,isLoading:!1})),{success:!1,message:"Login failed. Please try again."}}},r=async e=>{t(e=>({...e,isLoading:!0}));try{let i=await n.register(e);return i.success&&i.user?t({user:i.user,isAuthenticated:!0,isLoading:!1}):t(e=>({...e,isLoading:!1})),i}catch(e){return t(e=>({...e,isLoading:!1})),{success:!1,message:"Registration failed. Please try again."}}};return{...e,login:i,register:r,logout:()=>{n.logout(),t({user:null,isAuthenticated:!1,isLoading:!1})}}}},39714:(e,t,i)=>{"use strict";i.d(t,{C:()=>a});class a{static fileToDataUrl(e){return new Promise((t,i)=>{let a=new FileReader;a.onload=()=>t(a.result),a.onerror=i,a.readAsDataURL(e)})}static dataUrlToBlob(e){let t=e.split(","),i=t[0].match(/:(.*?);/)[1],a=atob(t[1]),r=a.length,s=new Uint8Array(r);for(;r--;)s[r]=a.charCodeAt(r);return new Blob([s],{type:i})}static resizeImage(e,t,i){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.8;return new Promise((r,s)=>{let o=document.createElement("canvas"),n=o.getContext("2d"),l=new Image;l.onload=()=>{let{width:e,height:d}=l;e>d?e>t&&(d=d*t/e,e=t):d>i&&(e=e*i/d,d=i),o.width=e,o.height=d,n.drawImage(l,0,0,e,d),o.toBlob(e=>{e?r(e):s(Error("Failed to create blob"))},"image/jpeg",a)},l.onerror=s,l.src=URL.createObjectURL(e)})}static captureFromVideo(e,t,i){let a=document.createElement("canvas"),r=a.getContext("2d"),s=t||e.videoWidth,o=i||e.videoHeight;a.width=s,a.height=o,r.drawImage(e,0,0,s,o);let n=a.toDataURL("image/jpeg",.8),l=this.dataUrlToBlob(n);return{id:Date.now().toString(),dataUrl:n,blob:l,timestamp:new Date,size:{width:s,height:o},fileSize:l.size}}static createImageElement(e){return new Promise((t,i)=>{let a=new Image;a.onload=()=>{t(a)},a.onerror=i,"string"==typeof e?a.src=e:a.src=URL.createObjectURL(e)})}static enhanceImage(e){let t=document.createElement("canvas"),i=t.getContext("2d");t.width=e.width,t.height=e.height,i.drawImage(e,0,0);let a=i.getImageData(0,0,t.width,t.height),r=a.data;for(let e=0;e<r.length;e+=4)r[e]=this.adjustContrast(r[e],1.2),r[e+1]=this.adjustContrast(r[e+1],1.2),r[e+2]=this.adjustContrast(r[e+2],1.2),r[e+1]=Math.min(255,1.1*r[e+1]);return i.putImageData(a,0,0),t}static adjustContrast(e,t){return Math.max(0,Math.min(255,(e-128)*t+128))}static extractColorStats(e){let t=document.createElement("canvas"),i=t.getContext("2d");t.width=e.width,t.height=e.height,i.drawImage(e,0,0);let a=i.getImageData(0,0,t.width,t.height).data,r=0,s=0,o=0,n=0,l=0,d=0,c=a.length/4;for(let e=0;e<a.length;e+=4){let t=a[e],i=a[e+1],c=a[e+2];r+=t,s+=i,o+=c,i>t&&i>c&&i>100?n++:t>100&&i>50&&c<100?l++:t>150&&i>150&&c<100&&d++}return{avgRed:r/c,avgGreen:s/c,avgBlue:o/c,greenRatio:n/c,brownRatio:l/c,yellowRatio:d/c}}static validateImage(e){return e.type.startsWith("image/")?e.size>0xa00000?{isValid:!1,error:"Image size should be less than 10MB"}:["image/jpeg","image/jpg","image/png","image/webp"].includes(e.type)?{isValid:!0}:{isValid:!1,error:"Supported formats: JPEG, PNG, WebP"}:{isValid:!1,error:"Please select a valid image file"}}static generateThumbnail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:150;return new Promise((i,a)=>{let r=document.createElement("canvas"),s=r.getContext("2d"),o=new Image;o.onload=()=>{let e=Math.min(o.width,o.height),a=(o.width-e)/2,n=(o.height-e)/2;r.width=t,r.height=t,s.drawImage(o,a,n,e,e,0,0,t,t),i(r.toDataURL("image/jpeg",.8))},o.onerror=a,o.src=URL.createObjectURL(e)})}}},41234:()=>{},49589:(e,t,i)=>{"use strict";i.d(t,{i:()=>g});var a=i(12115),r=i(12039);let s={bacterialSpot:[{id:"bs_copper_1",name:"Copper-based Fungicide",type:"chemical",description:"Copper hydroxide or copper sulfate spray for bacterial control",applicationMethod:"Foliar spray",dosage:"2-3 grams per liter of water",timing:"Early morning or late evening, every 7-10 days",precautions:["Wear protective equipment","Avoid spraying during flowering","Do not mix with alkaline products"],effectiveness:85},{id:"bs_organic_1",name:"Neem Oil Treatment",type:"organic",description:"Natural neem oil extract with antibacterial properties",applicationMethod:"Foliar spray",dosage:"5ml per liter of water",timing:"Weekly application, preferably in evening",precautions:["Test on small area first","Avoid during hot sunny days"],effectiveness:70},{id:"bs_bio_1",name:"Bacillus subtilis",type:"biological",description:"Beneficial bacteria that competes with pathogenic bacteria",applicationMethod:"Soil drench and foliar spray",dosage:"10g per liter of water",timing:"Bi-weekly application",precautions:["Store in cool, dry place","Use within expiry date"],effectiveness:75}],earlyBlight:[{id:"eb_fungicide_1",name:"Chlorothalonil",type:"chemical",description:"Broad-spectrum fungicide effective against early blight",applicationMethod:"Foliar spray",dosage:"2ml per liter of water",timing:"Every 7-14 days, start at first sign of disease",precautions:["Wear protective clothing","Avoid drift to water bodies","Rotate with other fungicides"],effectiveness:90},{id:"eb_organic_1",name:"Baking Soda Solution",type:"organic",description:"Sodium bicarbonate solution to alter leaf pH",applicationMethod:"Foliar spray",dosage:"5g per liter of water + 2ml liquid soap",timing:"Weekly application in dry weather",precautions:["Test on small area first","Apply in cooler parts of day"],effectiveness:60}],lateBlight:[{id:"lb_fungicide_1",name:"Metalaxyl + Mancozeb",type:"chemical",description:"Systemic and contact fungicide combination",applicationMethod:"Foliar spray",dosage:"2.5g per liter of water",timing:"Preventive application every 7-10 days",precautions:["Rotate with other modes of action","Avoid during rain","Use protective equipment"],effectiveness:95},{id:"lb_organic_1",name:"Copper Oxychloride",type:"organic",description:"Organic copper-based fungicide",applicationMethod:"Foliar spray",dosage:"3g per liter of water",timing:"Every 5-7 days during favorable conditions",precautions:["Avoid copper buildup in soil","Use sticker for better adhesion"],effectiveness:80}],leafMold:[{id:"lm_fungicide_1",name:"Propiconazole",type:"chemical",description:"Systemic triazole fungicide",applicationMethod:"Foliar spray",dosage:"1ml per liter of water",timing:"At first sign of symptoms, repeat every 14 days",precautions:["Limit applications per season","Rotate with different chemistry"],effectiveness:88},{id:"lm_organic_1",name:"Milk Spray",type:"organic",description:"Diluted milk solution with antifungal properties",applicationMethod:"Foliar spray",dosage:"100ml milk in 900ml water",timing:"Weekly application in dry weather",precautions:["Use fresh milk","Apply in morning hours"],effectiveness:65}],spiderMites:[{id:"sm_miticide_1",name:"Abamectin",type:"chemical",description:"Selective miticide with translaminar activity",applicationMethod:"Foliar spray",dosage:"1.5ml per liter of water",timing:"At first sign of mites, repeat after 7-10 days",precautions:["Avoid during bee activity","Use surfactant for better coverage"],effectiveness:92},{id:"sm_organic_1",name:"Insecticidal Soap",type:"organic",description:"Potassium salts of fatty acids",applicationMethod:"Foliar spray",dosage:"20ml per liter of water",timing:"Every 3-5 days until control achieved",precautions:["Test for phytotoxicity","Apply in cooler hours"],effectiveness:70},{id:"sm_bio_1",name:"Predatory Mites",type:"biological",description:"Phytoseiulus persimilis - natural predator",applicationMethod:"Release on plants",dosage:"2-5 mites per plant",timing:"Early infestation stage",precautions:["Avoid pesticide applications","Maintain humidity 60-70%"],effectiveness:85}]},o=[{id:"bacterial_spot",name:"Bacterial Spot",description:"A bacterial disease causing dark spots on leaves and fruits, leading to defoliation and reduced yield.",symptoms:["Small, dark brown to black spots on leaves","Spots may have yellow halos","Fruit lesions are raised and scabby","Severe defoliation in advanced stages","Reduced fruit quality and yield"],treatments:s.bacterialSpot,severity:"high"},{id:"early_blight",name:"Early Blight",description:"Fungal disease causing concentric ring spots on older leaves, progressing upward through the plant.",symptoms:["Brown spots with concentric rings (target spots)","Yellowing around spots","Spots start on older, lower leaves","Stem lesions may occur","Premature leaf drop"],treatments:s.earlyBlight,severity:"medium"},{id:"late_blight",name:"Late Blight",description:"Devastating fungal disease that can destroy entire crops rapidly under favorable conditions.",symptoms:["Water-soaked spots on leaves","White fuzzy growth on leaf undersides","Brown to black lesions","Rapid spread in cool, wet conditions","Fruit rot with brown lesions"],treatments:s.lateBlight,severity:"high"},{id:"leaf_mold",name:"Leaf Mold",description:"Fungal disease primarily affecting greenhouse-grown plants, causing yellowing and moldy growth.",symptoms:["Yellow spots on upper leaf surface","Olive-green to brown fuzzy growth underneath","Spots may merge to cover entire leaves","Leaves may curl and die","Reduced photosynthesis"],treatments:s.leafMold,severity:"medium"},{id:"septoria_leaf_spot",name:"Septoria Leaf Spot",description:"Fungal disease causing small circular spots with dark borders and light centers.",symptoms:["Small circular spots with dark borders","Light gray or tan centers","Tiny black specks (pycnidia) in spot centers","Lower leaves affected first","Progressive defoliation"],treatments:s.earlyBlight,severity:"medium"},{id:"spider_mites",name:"Spider Mites",description:"Tiny arachnids that feed on plant cells, causing stippling and webbing on leaves.",symptoms:["Fine stippling or speckling on leaves","Leaves may appear bronze or yellow","Fine webbing on leaves and stems","Leaves may drop prematurely","Reduced plant vigor"],treatments:s.spiderMites,severity:"medium"},{id:"target_spot",name:"Target Spot",description:"Fungal disease similar to early blight but with more distinct concentric rings.",symptoms:["Circular spots with distinct concentric rings","Brown to black coloration","Spots may have yellow halos","Affects leaves, stems, and fruits","Can cause significant defoliation"],treatments:s.earlyBlight,severity:"medium"},{id:"yellow_leaf_curl",name:"Yellow Leaf Curl Virus",description:"Viral disease transmitted by whiteflies, causing severe stunting and yield loss.",symptoms:["Upward curling of leaf margins","Yellowing of leaves","Stunted plant growth","Reduced fruit size and number","Thick, leathery leaf texture"],treatments:[{id:"ylc_prevention_1",name:"Whitefly Control",type:"chemical",description:"Control whitefly vectors to prevent virus transmission",applicationMethod:"Foliar spray",dosage:"As per insecticide label",timing:"Regular monitoring and treatment",precautions:["Rotate insecticide classes","Monitor for resistance"],effectiveness:70},{id:"ylc_organic_1",name:"Reflective Mulch",type:"organic",description:"Silver reflective mulch to repel whiteflies",applicationMethod:"Ground cover",dosage:"Complete soil coverage",timing:"Install before planting",precautions:["Ensure proper installation","Monitor for tears"],effectiveness:60}],severity:"high"},{id:"mosaic_virus",name:"Mosaic Virus",description:"Viral disease causing mottled patterns on leaves and reduced plant vigor.",symptoms:["Mottled light and dark green patterns","Leaf distortion and curling","Stunted growth","Reduced fruit quality","Yellowing and necrosis"],treatments:[{id:"mv_prevention_1",name:"Aphid Control",type:"chemical",description:"Control aphid vectors to prevent virus spread",applicationMethod:"Foliar spray",dosage:"As per insecticide label",timing:"Regular monitoring and treatment",precautions:["Use selective insecticides","Preserve beneficial insects"],effectiveness:65},{id:"mv_organic_1",name:"Crop Sanitation",type:"organic",description:"Remove infected plants and control weeds",applicationMethod:"Manual removal",dosage:"Complete removal of infected material",timing:"Immediate upon detection",precautions:["Disinfect tools","Proper disposal of infected material"],effectiveness:50}],severity:"high"},{id:"healthy",name:"Healthy Plant",description:"Plant shows no signs of disease and appears healthy with normal growth patterns.",symptoms:["Vibrant green foliage","Normal leaf shape and size","No spots, discoloration, or lesions","Good plant vigor","Normal fruit development"],treatments:[{id:"healthy_maintenance_1",name:"Preventive Care",type:"organic",description:"Maintain plant health through proper cultural practices",applicationMethod:"Cultural practices",dosage:"As needed",timing:"Ongoing",precautions:["Monitor regularly","Maintain proper nutrition"],effectiveness:95}],severity:"low"}],n=e=>o.find(t=>t.id===e);class l{async initializeModel(){if(!this.isLoading&&!this.isLoaded){this.isLoading=!0;try{await this.createDemoModel(),this.isLoaded=!0,console.log("Plant disease detection model loaded successfully")}catch(e){console.error("Error loading model:",e),this.isLoaded=!0}finally{this.isLoading=!1}}}async createDemoModel(){let e=r.ilg({layers:[r.ZFI.conv2d({inputShape:[224,224,3],filters:32,kernelSize:3,activation:"relu"}),r.ZFI.maxPooling2d({poolSize:2}),r.ZFI.conv2d({filters:64,kernelSize:3,activation:"relu"}),r.ZFI.maxPooling2d({poolSize:2}),r.ZFI.conv2d({filters:64,kernelSize:3,activation:"relu"}),r.ZFI.flatten(),r.ZFI.dense({units:64,activation:"relu"}),r.ZFI.dropout({rate:.5}),r.ZFI.dense({units:this.classNames.length,activation:"softmax"})]});e.compile({optimizer:"adam",loss:"categoricalCrossentropy",metrics:["accuracy"]}),this.model=e}async loadPretrainedModel(e){try{this.isLoading=!0,this.model=await r.O0W(e),this.isLoaded=!0,console.log("Pre-trained model loaded from:",e)}catch(e){throw console.error("Error loading pre-trained model:",e),e}finally{this.isLoading=!1}}preprocessImage(e){return r.DZQ(()=>{let t=r.TaL.fromPixels(e);return r.Slp.resizeBilinear(t,[224,224]).div(255).expandDims(0)})}simulateDetection(e){let{data:t,width:i,height:a}=e,r=0,s=0,o=0,n=i*a;for(let e=0;e<t.length;e+=4){let i=t[e],a=t[e+1],n=t[e+2];a>i&&a>n&&a>100?r++:i>100&&a>50&&n<100?s++:i>150&&a>150&&n<100&&o++}let l=r/n,d=s/n,c=o/n,g=Array(this.classNames.length).fill(0);l>.6&&d<.1&&c<.1?g[0]=.85+.1*Math.random():d>.2?(g[1]=.4+.3*Math.random(),g[2]=.3+.3*Math.random()):c>.3?(g[8]=.4+.3*Math.random(),g[9]=.3+.3*Math.random()):g[Math.floor(Math.random()*(this.classNames.length-1))+1]=.5+.3*Math.random();let u=g.reduce((e,t)=>e+t,0);if(u>0)for(let e=0;e<g.length;e++)g[e]/=u;let h=Math.max(...g);return{predictions:g,confidence:h}}async detectDisease(e){this.isLoaded||await this.initializeModel();try{let t,i;if(this.model){let a=this.preprocessImage(e),r=this.model.predict(a),s=await r.data();t=Array.from(s),i=Math.max(...t),a.dispose(),r.dispose()}else{let a=document.createElement("canvas"),r=a.getContext("2d");a.width=e.width,a.height=e.height,r.drawImage(e,0,0);let s=r.getImageData(0,0,a.width,a.height),o=this.simulateDetection(s);t=o.predictions,i=o.confidence}let a=t.indexOf(Math.max(...t)),r=this.classNames[a],s=[],o="healthy"===r;if(!o){let e=n(r);e&&s.push({...e,confidence:100*i})}return t.forEach((e,t)=>{if(t!==a&&e>.2&&"healthy"!==this.classNames[t]){let i=n(this.classNames[t]);i&&s.push({...i,confidence:100*e})}}),{id:Date.now().toString(),imageUrl:e.src,detectedDiseases:s,isHealthy:o,confidence:100*i,timestamp:new Date}}catch(e){throw console.error("Error during disease detection:",e),Error("Disease detection failed. Please try again.")}}isModelLoaded(){return this.isLoaded}isModelLoading(){return this.isLoading}getClassNames(){return[...this.classNames]}dispose(){this.model&&(this.model.dispose(),this.model=null,this.isLoaded=!1)}constructor(){this.model=null,this.isLoaded=!1,this.isLoading=!1,this.classNames=["healthy","bacterial_spot","early_blight","late_blight","leaf_mold","septoria_leaf_spot","spider_mites","target_spot","yellow_leaf_curl","mosaic_virus"],this.initializeModel()}}let d=new l;var c=i(39714);let g=()=>{let[e,t]=(0,a.useState)({isLoaded:!1,isLoading:!1,isAnalyzing:!1,error:null,lastResult:null,analysisHistory:[]});(0,a.useEffect)(()=>{d.isModelLoaded()?t(e=>({...e,isLoaded:!0})):d.isModelLoading()&&t(e=>({...e,isLoading:!0})),i()},[]);let i=(0,a.useCallback)(()=>{try{let e=localStorage.getItem("agrodrone_analysis_history");if(e){let i=JSON.parse(e);t(e=>({...e,analysisHistory:i}))}}catch(e){console.error("Error loading analysis history:",e)}},[]),r=(0,a.useCallback)(e=>{try{localStorage.setItem("agrodrone_analysis_history",JSON.stringify(e))}catch(e){console.error("Error saving analysis history:",e)}},[]),s=(0,a.useCallback)(async e=>{try{if(t(e=>({...e,isAnalyzing:!0,error:null})),e instanceof File){let t=c.C.validateImage(e);if(!t.isValid)throw Error(t.error)}let i=await c.C.createImageElement(e),a=c.C.enhanceImage(i),s=new Image;s.src=a.toDataURL(),await new Promise(e=>{s.onload=e});let o=await d.detectDisease(s);if(navigator.geolocation)try{let e=await new Promise((e,t)=>{navigator.geolocation.getCurrentPosition(e,t,{timeout:5e3,enableHighAccuracy:!1})});o.location={latitude:e.coords.latitude,longitude:e.coords.longitude}}catch(e){console.log("Location not available:",e)}return t(e=>{let t=[o,...e.analysisHistory].slice(0,50);return r(t),{...e,isAnalyzing:!1,lastResult:o,analysisHistory:t,error:null}}),o}catch(i){let e=i instanceof Error?i.message:"Analysis failed";return t(t=>({...t,isAnalyzing:!1,error:e})),null}},[r]),o=(0,a.useCallback)(async e=>await s(e.blob),[s]),n=(0,a.useCallback)(()=>{t(e=>({...e,analysisHistory:[]})),localStorage.removeItem("agrodrone_analysis_history")},[]),l=(0,a.useCallback)(e=>{t(t=>{let i=t.analysisHistory.filter(t=>t.id!==e);return r(i),{...t,analysisHistory:i}})},[r]),g=(0,a.useCallback)(()=>{let{analysisHistory:t}=e,i=t.length,a=t.filter(e=>e.isHealthy).length,r={};t.forEach(e=>{e.detectedDiseases.forEach(e=>{r[e.name]=(r[e.name]||0)+1})});let s=Object.entries(r).sort((e,t)=>{let[,i]=e,[,a]=t;return a-i})[0],o=t.length>0?t.reduce((e,t)=>e+t.confidence,0)/t.length:0;return{totalAnalyses:i,healthyCount:a,diseasedCount:i-a,healthyPercentage:i>0?a/i*100:0,diseaseFrequency:r,mostCommonDisease:s?{name:s[0],count:s[1]}:null,averageConfidence:o}},[e.analysisHistory]),u=(0,a.useCallback)(async e=>{try{return t(e=>({...e,isLoading:!0,error:null})),await d.loadPretrainedModel(e),t(e=>({...e,isLoaded:!0,isLoading:!1,error:null})),{success:!0}}catch(i){let e=i instanceof Error?i.message:"Failed to load model";return t(t=>({...t,isLoading:!1,error:e})),{success:!1,error:e}}},[]),h=(0,a.useCallback)(async()=>e.lastResult?await s(e.lastResult.imageUrl):null,[e.lastResult,s]);return{...e,analyzeImage:s,analyzeImageFromCamera:o,clearHistory:n,removeFromHistory:l,getAnalysisStats:g,loadPretrainedModel:u,retryAnalysis:h,classNames:d.getClassNames()}}},59434:(e,t,i)=>{"use strict";i.d(t,{cn:()=>s});var a=i(52596),r=i(39688);function s(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return(0,r.QP)((0,a.$)(t))}},66695:(e,t,i)=>{"use strict";i.d(t,{BT:()=>l,Wu:()=>d,ZB:()=>n,Zp:()=>s,aR:()=>o});var a=i(95155);i(12115);var r=i(59434);function s(e){let{className:t,...i}=e;return(0,a.jsx)("div",{"data-slot":"card",className:(0,r.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...i})}function o(e){let{className:t,...i}=e;return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,r.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...i})}function n(e){let{className:t,...i}=e;return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,r.cn)("leading-none font-semibold",t),...i})}function l(e){let{className:t,...i}=e;return(0,a.jsx)("div",{"data-slot":"card-description",className:(0,r.cn)("text-muted-foreground text-sm",t),...i})}function d(e){let{className:t,...i}=e;return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,r.cn)("px-6",t),...i})}},80551:()=>{},85817:()=>{}}]);